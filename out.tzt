INFO 01-04 11:56:29 [api_server.py:1351] vLLM API server version 0.13.0rc2.dev21+g6ccb7baeb.d20260104
INFO 01-04 11:56:29 [utils.py:253] non-default args: {'tool_call_parser': 'hermes', 'model': 'Qwen/Qwen3-4B-Instruct-2507', 'seed': None, 'logprobs_mode': 'processed_logprobs', 'worker_extension_cls': 'prime_rl.inference.vllm.worker.filesystem.FileSystemWeightUpdateWorker', 'enable_lora': True}
WARNING 01-04 11:56:29 [arg_utils.py:1209] `seed=None` is equivalent to `seed=0` in V1 Engine. You will no longer be allowed to pass `None` in v0.13.
INFO 01-04 11:56:30 [model.py:629] Resolved architecture: Qwen3ForCausalLM
INFO 01-04 11:56:30 [model.py:1755] Using max model len 262144
INFO 01-04 11:56:30 [scheduler.py:228] Chunked prefill is enabled with max_num_batched_tokens=8192.
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:31 [core.py:93] Initializing a V1 LLM engine (v0.13.0rc2.dev21+g6ccb7baeb.d20260104) with config: model='Qwen/Qwen3-4B-Instruct-2507', speculative_config=None, tokenizer='Qwen/Qwen3-4B-Instruct-2507', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=262144, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=Qwen/Qwen3-4B-Instruct-2507, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [8192], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 512, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:31 [worker_base.py:283] Injected <class 'prime_rl.inference.vllm.worker.filesystem.FileSystemWeightUpdateWorker'> into <class 'vllm.v1.worker.gpu_worker.Worker'> for extended collective_rpc calls ['init_broadcaster', 'update_weights']
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:31 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://129.114.18.3:34255 backend=nccl
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:31 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:33 [gpu_model_runner.py:3560] Starting to load model Qwen/Qwen3-4B-Instruct-2507...
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:33 [cuda.py:412] Using FLASH_ATTN attention backend out of potential backends: ['FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION']
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:35 [default_loader.py:308] Loading weights took 0.75 seconds
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:35 [punica_selector.py:20] Using PunicaWrapperGPU.
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:35 [gpu_model_runner.py:3642] Model loading took 7.6684 GiB memory and 1.796731 seconds
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:44 [backends.py:616] Using cache directory: /home1/09143/arnabd/.cache/vllm/torch_compile_cache/10d74b6e48/rank_0_0/backbone for vLLM's torch.compile
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:44 [backends.py:676] Dynamo bytecode transform time: 8.31 s
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:48 [backends.py:243] Cache the graph of compile range (1, 8192) for later use
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:52 [backends.py:260] Compiling a graph for compile range (1, 8192) takes 3.52 s
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:52 [monitor.py:34] torch.compile takes 11.83 s in total
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:52 [gpu_worker.py:370] Available KV cache memory: 72.11 GiB
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:53 [kv_cache_utils.py:1287] GPU KV cache size: 525,072 tokens
[0;36m(EngineCore_DP0 pid=2674274)[0;0m INFO 01-04 11:56:53 [kv_cache_utils.py:1292] Maximum concurrency for 262,144 tokens per request: 2.00x
[0;36m(EngineCore_DP0 pid=2674274)[0;0m WARNING 01-04 11:56:53 [utils.py:250] Using default LoRA kernel configs
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866] EngineCore failed to start.
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 857, in run_engine_core
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 637, in __init__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     super().__init__(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 109, in __init__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 256, in _initialize_kv_caches
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self.model_executor.initialize_from_config(kv_cache_configs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/executor/abstract.py", line 116, in initialize_from_config
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self.collective_rpc("compile_or_warm_up_model")
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/serial_utils.py", line 461, in run_method
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_worker.py", line 454, in compile_or_warm_up_model
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     cuda_graph_memory_bytes = self.model_runner.capture_model()
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4530, in capture_model
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self._capture_cudagraphs(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4627, in _capture_cudagraphs
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self._dummy_run(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4165, in _dummy_run
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     outputs = self.model(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]               ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/cuda_graph.py", line 220, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self.runnable(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/model_executor/models/qwen3.py", line 315, in forward
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/decorators.py", line 435, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/wrapper.py", line 221, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._call_with_optional_nvtx_range(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return callable_fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/model_executor/models/qwen2.py", line 389, in forward
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     def forward(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/caching.py", line 54, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self.optimized_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 837, in call_wrapped
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 413, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     raise e
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 400, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "<eval_with_key>.74", line 808, in forward
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     submod_0 = self.submod_0(l_input_ids_, s72, l_self_modules_embed_tokens_parameters_weight_, l_self_modules_layers_modules_0_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_modules_base_layer_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_token_lora_mapping, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_token_indices_sorted_by_lora_ids, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_0_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_1_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_2_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_num_tokens_per_lora, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_lora_token_start_loc, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_active_lora_ids, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_no_lora_flag_cpu, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_0_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_1_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_2_, l_self_modules_layers_modules_0_modules_self_attn_modules_q_norm_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_k_norm_parameters_weight_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  l_input_ids_ = l_self_modules_embed_tokens_parameters_weight_ = l_self_modules_layers_modules_0_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_modules_base_layer_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_0_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_1_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_2_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_0_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_1_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_2_ = l_self_modules_layers_modules_0_modules_self_attn_modules_q_norm_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_k_norm_parameters_weight_ = None
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/cuda_graph.py", line 220, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self.runnable(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/piecewise_backend.py", line 183, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return range_entry.runnable(*args)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._compiled_fn(*args)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return compiled_fn(full_args)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     all_outs = call_func_at_runtime_with_args(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     out = normalize_as_list(f(args))
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                             ^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return compiled_fn(runtime_args)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/output_code.py", line 613, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self.current_callable(inputs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/utils.py", line 2962, in run
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     out = model(new_inputs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]           ^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/tmp/torchinductor_arnabd/fb/cfbrrwm7c7tpiydahyar63adhwjollbauv5xum5wwyvhn4m5s26k.py", line 858, in call
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     torch.ops.vllm.lora_shrink.default(buf2, [arg7_1, arg8_1, arg9_1], buf3, reinterpret_tensor(arg5_1, (s72, ), (1, ), 0), reinterpret_tensor(arg6_1, (s72, ), (1, ), 0), arg10_1, arg11_1, arg12_1, arg13_1, 1.0)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_ops.py", line 841, in __call__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/lora/ops/triton_ops/lora_shrink_op.py", line 225, in _lora_shrink
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     _lora_shrink_kernel[grid](
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/jit.py", line 419, in <lambda>
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/jit.py", line 756, in run
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/compiler/compiler.py", line 490, in launch_metadata
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self._init_handles()
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/compiler/compiler.py", line 460, in _init_handles
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     self._run = driver.active.launcher_cls(self.src, self.metadata)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/driver.py", line 682, in __init__
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     mod = compile_module_from_src(
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/build.py", line 89, in compile_module_from_src
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     so = _build(name, src_path, tmpdir, library_dirs or [], include_dirs or [], libraries or [], ccflags or [])
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/build.py", line 51, in _build
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     subprocess.check_call(cc_cmd, stdout=subprocess.DEVNULL)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]   File "/home1/09143/arnabd/.local/share/uv/python/cpython-3.12.11-linux-aarch64-gnu/lib/python3.12/subprocess.py", line 413, in check_call
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866]     raise CalledProcessError(retcode, cmd)
[0;36m(EngineCore_DP0 pid=2674274)[0;0m ERROR 01-04 11:56:54 [core.py:866] subprocess.CalledProcessError: Command '['/home1/apps/nvidia/Linux_aarch64/24.7/compilers/bin/nvc', '/tmp/tmp62rsgaxl/__triton_launcher.c', '-O3', '-shared', '-fPIC', '-Wno-psabi', '-o', '/tmp/tmp62rsgaxl/__triton_launcher.cpython-312-aarch64-linux-gnu.so', '-lcuda', '-L/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/lib', '-L/lib64', '-I/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/include', '-I/tmp/tmp62rsgaxl', '-I/home1/09143/arnabd/.local/share/uv/python/cpython-3.12.11-linux-aarch64-gnu/include/python3.12']' returned non-zero exit status 1.
INFO 01-04 11:57:44 [api_server.py:1351] vLLM API server version 0.13.0rc2.dev21+g6ccb7baeb.d20260104
INFO 01-04 11:57:44 [utils.py:253] non-default args: {'tool_call_parser': 'hermes', 'model': 'Qwen/Qwen3-4B-Instruct-2507', 'seed': None, 'logprobs_mode': 'processed_logprobs', 'worker_extension_cls': 'prime_rl.inference.vllm.worker.filesystem.FileSystemWeightUpdateWorker', 'enable_lora': True}
WARNING 01-04 11:57:44 [arg_utils.py:1209] `seed=None` is equivalent to `seed=0` in V1 Engine. You will no longer be allowed to pass `None` in v0.13.
INFO 01-04 11:57:45 [model.py:629] Resolved architecture: Qwen3ForCausalLM
INFO 01-04 11:57:45 [model.py:1755] Using max model len 262144
INFO 01-04 11:57:45 [scheduler.py:228] Chunked prefill is enabled with max_num_batched_tokens=8192.
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:46 [core.py:93] Initializing a V1 LLM engine (v0.13.0rc2.dev21+g6ccb7baeb.d20260104) with config: model='Qwen/Qwen3-4B-Instruct-2507', speculative_config=None, tokenizer='Qwen/Qwen3-4B-Instruct-2507', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=262144, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=Qwen/Qwen3-4B-Instruct-2507, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [8192], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': True, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 512, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:46 [worker_base.py:283] Injected <class 'prime_rl.inference.vllm.worker.filesystem.FileSystemWeightUpdateWorker'> into <class 'vllm.v1.worker.gpu_worker.Worker'> for extended collective_rpc calls ['init_broadcaster', 'update_weights']
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:46 [parallel_state.py:1203] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://129.114.18.3:44203 backend=nccl
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:46 [parallel_state.py:1411] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:47 [gpu_model_runner.py:3560] Starting to load model Qwen/Qwen3-4B-Instruct-2507...
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:48 [cuda.py:412] Using FLASH_ATTN attention backend out of potential backends: ['FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION']
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:49 [default_loader.py:308] Loading weights took 0.74 seconds
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:49 [punica_selector.py:20] Using PunicaWrapperGPU.
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:49 [gpu_model_runner.py:3642] Model loading took 7.6684 GiB memory and 1.734739 seconds
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:59 [backends.py:616] Using cache directory: /home1/09143/arnabd/.cache/vllm/torch_compile_cache/10d74b6e48/rank_0_0/backbone for vLLM's torch.compile
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:57:59 [backends.py:676] Dynamo bytecode transform time: 8.85 s
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:03 [backends.py:243] Cache the graph of compile range (1, 8192) for later use
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:06 [backends.py:260] Compiling a graph for compile range (1, 8192) takes 3.47 s
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:06 [monitor.py:34] torch.compile takes 12.32 s in total
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:07 [gpu_worker.py:370] Available KV cache memory: 72.11 GiB
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:07 [kv_cache_utils.py:1287] GPU KV cache size: 525,072 tokens
[0;36m(EngineCore_DP0 pid=2674355)[0;0m INFO 01-04 11:58:07 [kv_cache_utils.py:1292] Maximum concurrency for 262,144 tokens per request: 2.00x
[0;36m(EngineCore_DP0 pid=2674355)[0;0m WARNING 01-04 11:58:08 [utils.py:250] Using default LoRA kernel configs
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866] EngineCore failed to start.
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 857, in run_engine_core
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 637, in __init__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     super().__init__(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 109, in __init__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/engine/core.py", line 256, in _initialize_kv_caches
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self.model_executor.initialize_from_config(kv_cache_configs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/executor/abstract.py", line 116, in initialize_from_config
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self.collective_rpc("compile_or_warm_up_model")
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/serial_utils.py", line 461, in run_method
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_worker.py", line 454, in compile_or_warm_up_model
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     cuda_graph_memory_bytes = self.model_runner.capture_model()
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4530, in capture_model
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self._capture_cudagraphs(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4627, in _capture_cudagraphs
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self._dummy_run(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/v1/worker/gpu_model_runner.py", line 4165, in _dummy_run
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     outputs = self.model(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]               ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/cuda_graph.py", line 220, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self.runnable(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/model_executor/models/qwen3.py", line 315, in forward
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/decorators.py", line 435, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/wrapper.py", line 221, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._call_with_optional_nvtx_range(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/wrapper.py", line 109, in _call_with_optional_nvtx_range
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return callable_fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/model_executor/models/qwen2.py", line 389, in forward
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     def forward(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/caching.py", line 54, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self.optimized_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 837, in call_wrapped
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._wrapped_call(self, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 413, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     raise e
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/fx/graph_module.py", line 400, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return super(self.cls, obj).__call__(*args, **kwargs)  # type: ignore[misc]
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "<eval_with_key>.74", line 808, in forward
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     submod_0 = self.submod_0(l_input_ids_, s72, l_self_modules_embed_tokens_parameters_weight_, l_self_modules_layers_modules_0_modules_input_layernorm_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_modules_base_layer_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_token_lora_mapping, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_token_indices_sorted_by_lora_ids, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_0_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_1_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_2_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_num_tokens_per_lora, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_lora_token_start_loc, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_active_lora_ids, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_punica_wrapper_token_mapping_meta_no_lora_flag_cpu, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_0_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_1_, l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_2_, l_self_modules_layers_modules_0_modules_self_attn_modules_q_norm_parameters_weight_, l_self_modules_layers_modules_0_modules_self_attn_modules_k_norm_parameters_weight_, l_positions_, l_self_modules_layers_modules_0_modules_self_attn_modules_rotary_emb_buffers_cos_sin_cache_);  l_input_ids_ = l_self_modules_embed_tokens_parameters_weight_ = l_self_modules_layers_modules_0_modules_input_layernorm_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_modules_base_layer_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_0_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_1_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_a_stacked_2_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_0_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_1_ = l_self_modules_layers_modules_0_modules_self_attn_modules_qkv_proj_lora_b_stacked_2_ = l_self_modules_layers_modules_0_modules_self_attn_modules_q_norm_parameters_weight_ = l_self_modules_layers_modules_0_modules_self_attn_modules_k_norm_parameters_weight_ = None
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/cuda_graph.py", line 220, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self.runnable(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/compilation/piecewise_backend.py", line 183, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return range_entry.runnable(*args)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 63, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._compiled_fn(*args)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return fn(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/aot_autograd.py", line 1130, in forward
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return compiled_fn(full_args)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 353, in runtime_wrapper
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     all_outs = call_func_at_runtime_with_args(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/utils.py", line 129, in call_func_at_runtime_with_args
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     out = normalize_as_list(f(args))
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                             ^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 526, in wrapper
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return compiled_fn(runtime_args)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/output_code.py", line 613, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self.current_callable(inputs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_inductor/utils.py", line 2962, in run
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     out = model(new_inputs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]           ^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/tmp/torchinductor_arnabd/fb/cfbrrwm7c7tpiydahyar63adhwjollbauv5xum5wwyvhn4m5s26k.py", line 858, in call
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     torch.ops.vllm.lora_shrink.default(buf2, [arg7_1, arg8_1, arg9_1], buf3, reinterpret_tensor(arg5_1, (s72, ), (1, ), 0), reinterpret_tensor(arg6_1, (s72, ), (1, ), 0), arg10_1, arg11_1, arg12_1, arg13_1, 1.0)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/_ops.py", line 841, in __call__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/proj8/vllm/vllm/lora/ops/triton_ops/lora_shrink_op.py", line 225, in _lora_shrink
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     _lora_shrink_kernel[grid](
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/jit.py", line 419, in <lambda>
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/jit.py", line 756, in run
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     launch_metadata = kernel.launch_metadata(grid, stream, *bound_args.values())
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/compiler/compiler.py", line 490, in launch_metadata
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self._init_handles()
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/compiler/compiler.py", line 460, in _init_handles
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     self._run = driver.active.launcher_cls(self.src, self.metadata)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/driver.py", line 682, in __init__
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     mod = compile_module_from_src(
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/build.py", line 89, in compile_module_from_src
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     so = _build(name, src_path, tmpdir, library_dirs or [], include_dirs or [], libraries or [], ccflags or [])
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/runtime/build.py", line 51, in _build
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     subprocess.check_call(cc_cmd, stdout=subprocess.DEVNULL)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]   File "/home1/09143/arnabd/.local/share/uv/python/cpython-3.12.11-linux-aarch64-gnu/lib/python3.12/subprocess.py", line 413, in check_call
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866]     raise CalledProcessError(retcode, cmd)
[0;36m(EngineCore_DP0 pid=2674355)[0;0m ERROR 01-04 11:58:08 [core.py:866] subprocess.CalledProcessError: Command '['/home1/apps/nvidia/Linux_aarch64/24.7/compilers/bin/nvc', '/tmp/tmptlxpd2l0/__triton_launcher.c', '-O3', '-shared', '-fPIC', '-Wno-psabi', '-o', '/tmp/tmptlxpd2l0/__triton_launcher.cpython-312-aarch64-linux-gnu.so', '-lcuda', '-L/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/lib', '-L/lib64', '-I/scratch/09143/arnabd/newproj/prime-rl/.venv/lib/python3.12/site-packages/triton/backends/nvidia/include', '-I/tmp/tmptlxpd2l0', '-I/home1/09143/arnabd/.local/share/uv/python/cpython-3.12.11-linux-aarch64-gnu/include/python3.12']' returned non-zero exit status 1.
